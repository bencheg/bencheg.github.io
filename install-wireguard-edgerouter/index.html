<!DOCTYPE html>
<html lang="ru"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ü—Ä–∏–≤–µ—Ç! üëã –ó–¥–µ—Å—å —è –ø—É–±–ª–∏–∫—É—é –∑–∞–º–µ—Ç–∫–∏ –æ —Ä–∞–∑–Ω—ã—Ö IT —à—Ç—É–∫–∞—Ö –∏ –Ω–µ —Ç–æ–ª—å–∫–æ. –¢–æ, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –º–Ω–µ –∏ —á–µ–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è.">
    

    
    <link rel="shortcut icon" type="image/x-icon" href="https://marand.ru/images/favicon.jpg" />
    
    <link rel="stylesheet" href="/css/style.min.css">

    <link rel="canonical" href="https://marand.ru/install-wireguard-edgerouter/" />
    <title>Edgerouter: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Wireguard</title>
</head>
<body><header id="banner">
    <h2><a href="https://marand.ru">marand.ru</a></h2>
    <nav>
        <ul>
            <li>
                <a href="/" title="–ü–æ—Å—Ç—ã">–ü–æ—Å—Ç—ã</a>
            </li>
        </ul>
    </nav>
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>Edgerouter: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Wireguard</h1>
        <div>
                <time>01 –¥–µ–∫–∞–±—Ä—è 2022</time>
            <a href='/tags/edgerouter'>edgerouter</a>, <a href='/tags/wireguard'>wireguard</a></div>
    </header><p><img src="/images/wireguard.png" alt=""></p>
<p>Wireguard –æ—Ç–ª–∏—á–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ <mark>openvpn</mark>. –ê –ø–æ —á–∞—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–∫ –≤–æ–æ–±—â–µ –Ω–∞ —Ç—Ä–∏ –≥–æ–ª–æ–≤—ã –≤–ø–µ—Ä–µ–¥–∏. –Ø –∏—Å–ø–æ–ª—å–∑—É—é wg –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç—É–Ω–Ω–µ–ª—è –≤ –¥–æ–º–∞—à–Ω—é—é —Å–µ—Ç—å.</p>
<h1 id="—Å—Ç–∞–≤–∏–º-wireguard">–°—Ç–∞–≤–∏–º wireguard</h1>
<p>–ò–¥–µ–º –Ω–∞ <a href="https://github.com/WireGuard/wireguard-vyatta-ubnt/releases">github</a> –∏ –∫–æ–ø–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ deb –ø–∞–∫–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ—à–∏–≤–∫–∏ –∏ –º–æ–¥–µ–ª–∏ —Ä–æ—É—Ç–µ—Ä–∞. –í –º–æ–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ <strong>e50-v2-v1.0.20211208-v1.0.20210914.deb</strong>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">user@ubnt:~$ curl -OL link-to-deb
</span></span><span class="line"><span class="cl">user@ubnt:~$ sudo dpkg -i e50-v2-v1.0.20211208-v1.0.20210914.deb</span></span></code></pre></div></p>
<p>–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–∏:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">wg genkey <span class="p">|</span> tee /config/auth/wg.key <span class="p">|</span> wg pubkey &gt;  wg.public</span></span></code></pre></div>
–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –±—É–¥–µ—Ç –ª–µ–∂–∞—Ç—å –≤ <code>/config/auth/wg.key</code>, –ø—É–±–ª–∏—á–Ω—ã–π –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –ü–æ—Ç–æ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–∞–Ω–¥–æ–π <code>sudo wg show</code></p>
<h1 id="–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å-–Ω–∞-—Ä–æ—É—Ç–µ—Ä–µ">–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ:</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">configure
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 address 192.168.5.1/24
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 listen-port <span class="m">51820</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 route-allowed-ips <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 private-key /config/auth/wg.key
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">commit
</span></span><span class="line"><span class="cl">save</span></span></code></pre></div>
<h1 id="–¥–æ–±–∞–≤–ª—è–µ–º-peer">–î–æ–±–∞–≤–ª—è–µ–º peer</h1>
<p>–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Wireguard —á—Ç–æ –Ω–∞ ios, —á—Ç–æ –≤ macos, —á—Ç–æ –≤ windows –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–æ–º, –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:</p>
<p><img src="/images/wg_windows.png#center" alt="">
<img src="/images/macos_wireguard.png#center" alt="">
<img src="/images/wg_ios.png#center" alt=""></p>
<p>–ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º <strong>–ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Ä–æ—É—Ç–µ—Ä–∞</strong>, –µ–≥–æ <strong>ip</strong> –∏ <strong>–ø–æ—Ä—Ç</strong>. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º ip –∞–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º - –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ 192.168.5.2, –Ω–∞ –º–∞–∫–±—É–∫–µ 192.168.5.3 –∏ —Ç.–¥.<br>
–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è macos –∏ windows:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">[</span>Interface<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">PrivateKey</span> <span class="o">=</span> –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –ø–∏—Ä–∞
</span></span><span class="line"><span class="cl"><span class="nv">Address</span> <span class="o">=</span> 192.168.5.3/32
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Peer<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">PublicKey</span> <span class="o">=</span> –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Ä–æ—É—Ç–µ—Ä–∞
</span></span><span class="line"><span class="cl"><span class="nv">AllowedIPs</span> <span class="o">=</span> 192.168.5.0/24, 192.168.1.0/24 // —É–∫–∞–∑—ã–≤–∞–µ–º —Å–µ—Ç–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø
</span></span><span class="line"><span class="cl"><span class="nv">Endpoint</span> <span class="o">=</span> ip:51820 //–≤–Ω–µ—à–Ω–∏–π –∞–¥—Ä–µ—Å —Ä–æ—É—Ç–µ—Ä–∞
</span></span><span class="line"><span class="cl"><span class="nv">PersistentKeepalive</span> <span class="o">=</span> <span class="m">15</span></span></span></code></pre></div></p>
<h1 id="–¥–æ–±–∞–≤–ª—è–µ–º-peer-–≤-–∫–æ–Ω—Ñ–∏–≥-—Ä–æ—É—Ç–µ—Ä–∞">–î–æ–±–∞–≤–ª—è–µ–º peer –≤ –∫–æ–Ω—Ñ–∏–≥ —Ä–æ—É—Ç–µ—Ä–∞</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">configure
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 peer –ø—É–±–ª–∏—á–Ω—ã–π_–∫–ª—é—á_–ø–∏—Ä–∞1 allowed-ips 192.168.5.2/32
</span></span><span class="line"><span class="cl"><span class="nb">set</span> interfaces wireguard wg0 peer –ø—É–±–ª–∏—á–Ω—ã–π_–∫–ª—é—á_–ø–∏—Ä–∞2 allowed-ips 192.168.5.3/32
</span></span><span class="line"><span class="cl">commit
</span></span><span class="line"><span class="cl">save</span></span></code></pre></div>
<h1 id="–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º-—Ñ–∞–π—Ä–≤–æ–ª">–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–∞–π—Ä–≤–æ–ª</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">configure
</span></span><span class="line"><span class="cl"><span class="nb">set</span> firewall name WAN_LOCAL rule <span class="m">20</span> action accept
</span></span><span class="line"><span class="cl"><span class="nb">set</span> firewall name WAN_LOCAL rule <span class="m">20</span> protocol udp
</span></span><span class="line"><span class="cl"><span class="nb">set</span> firewall name WAN_LOCAL rule <span class="m">20</span> description <span class="s1">&#39;WireGuard&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> firewall name WAN_LOCAL rule <span class="m">20</span> destination port <span class="m">51820</span>
</span></span><span class="line"><span class="cl">commit
</span></span><span class="line"><span class="cl">save</span></span></code></pre></div>
<p>–í—Å–µ, vpn –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –¥–æ—Å—Ç—É–ø –≤ –¥–æ–º–∞—à–Ω—é—é —Å–µ—Ç—å –µ—Å—Ç—å –∫–∞–∫ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Ç–∞–∫ –∏ —Å –Ω–æ—É—Ç–±—É–∫–∞.</p>
</article>

        </main><footer id="footer">
    
</footer>


<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
    ym(92841410, "init", {
         clickmap:true,
         trackLinks:true,
         accurateTrackBounce:true
    });
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/92841410" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 
</body>
</html>
